# CVE-2025-30208 – Vite `/@fs/` Path Traversal – Report & Mitigation

**Document date:** February 2026  
**Project:** Pocket Explorer  
**Status:** Mitigated (middleware block); planned upgrade to Vite v7

---

## 1. Vulnerability Summary

**CVE-2025-30208** affects Vite’s development server handling of the `/@fs/` virtual path. The dev server serves files from the filesystem via this path; insufficient validation allows path traversal, so attackers can request arbitrary files (e.g. `/etc/passwd`, `/proc/self/environ`) and receive their contents.

- **Affected:** Vite dev server when exposed (e.g. to the internet or untrusted networks).
- **Impact:** Read of arbitrary files on the server (sensitive config, env vars, secrets).
- **Our stack:** Vite **v4.4.9** (see `package.json`).

---

## 2. Log Review – Evidence of Exploitation

Access logs were reviewed for the `/@fs/` path pattern. **Exploitation did occur** before the fix was deployed.

### 2.1 Successful exploitation (HTTP 200)

| Date (UTC) | Client IP        | Path requested                         | Status | Size   | Notes                    |
|------------|------------------|----------------------------------------|--------|--------|--------------------------|
| 16 Feb 2026 | 109.105.210.92  | `/@fs/etc/services?import&?inline=1.wasm?init` | 200 | 132 B  | System file              |
| 16 Feb 2026 | 109.105.210.92  | `/@fs/C:%5CWindows%5C...%5Cservices?...`       | 200 | 165 B  | Windows path probe       |
| 16 Feb 2026 | 45.156.128.39   | Same as above (both paths)             | 200 | -      | Automated scan           |
| 18 Feb 2026 | 45.156.128.49   | Same as above                          | 200 | -      | Automated scan           |
| 18 Feb 2026 | 104.28.213.127  | `/@fs/etc/passwd?raw??`                | 200 | 914 B  | User list exposed        |
| 18 Feb 2026 | 104.28.213.127  | `/@fs/proc/self/environ?raw??`         | 200 | 1869 B | **High risk – env vars** |
| 18 Feb 2026 | 104.28.245.127  | `/@fs/proc/self/environ?raw??`         | 200 | 1869 B | **High risk**            |
| 18 Feb 2026 | 104.28.213.128  | `/@fs/etc/passwd?raw??`                | 200 | 914 B  | User list exposed        |
| 18 Feb 2026 | 104.28.213.128  | `/@fs/proc/self/environ?raw??`         | 200 | 1869 B | **High risk**            |
| 18 Feb 2026 | 104.28.213.128  | `/@fs/proc/self/cmdline?raw??`         | 200 | 95 B   | Process info             |
| 18 Feb 2026 | 104.28.213.128  | `/@fs/proc/cmdline?raw??`              | 200 | 112 B  | Kernel/cmdline           |
| 18 Feb 2026 | 104.28.213.127  | `/@fs/etc/passwd?raw??` (304)          | 304 | 0      | Cached                   |
| 19 Feb 2026 | 154.198.93.237  | `/@fs/etc/passwd?raw??`                | 200 | 914 B  | User list exposed        |

**Highest risk:** `/proc/self/environ` was returned (1869 bytes). That can include API keys, database credentials, and other secrets from the process environment. Rotation of any such credentials is recommended.

### 2.2 Blocked attempts (HTTP 403)

Some requests to `/@fs/etc/passwd` returned 403 (e.g. after mitigation or WAF). The log set also shows multiple 200 responses for the same and other paths, confirming prior successful exploitation.

### 2.3 IPs of interest (scanners/attackers)

- `109.105.210.92`
- `45.156.128.39`, `45.156.128.49`
- `104.28.213.127`, `104.28.213.128`, `104.28.245.127`
- `154.198.93.237`

Consider blocking or monitoring these if not already handled by WAF/firewall.

---

## 3. Mitigation Implemented

We do **not** rely on the vulnerable Vite behaviour. We block `/@fs/` at the edge using the existing security middleware in `vite.config.ts`.

### 3.1 Change

The pattern **`'/@fs/'`** was added to **`SUSPICIOUS_PATTERNS`** so that any request whose URL contains `/@fs/` is rejected before it reaches Vite’s dev server.

**File:** `vite.config.ts`

```ts
// Security patterns to block
const SUSPICIOUS_PATTERNS = [
  'eval-stdin.php',
  'think\\app',
  '.git/config',
  '_profiler',
  'wp-login',
  'wp-admin',
  'install.php',
  'phpMyAdmin',
  'invokefunction',
  '../',
  '/@fs/',   // CVE-2025-30208 – Vite @fs path traversal
  '..%2f',
  '%2e%2e%2f', // URL encoded ../
];
```

The **security plugin** runs first in the Vite dev server pipeline. If the request URL contains any of these patterns, the middleware responds with **403 Forbidden** and does not call `next()`, so Vite never serves the requested path.

### 3.2 Why this is sufficient for this CVE

- All exploitation attempts observed in logs use the literal path `/@fs/` (or encoded variants that still contain `/@fs/` in the URL we inspect).
- Blocking on the presence of `/@fs/` in the URL prevents the vulnerable Vite handler from being reached, so the path traversal is not exploitable through our dev server while this middleware is in place.

---

## 4. Planned Upgrade – Vite v4 → v7

- **Current:** Vite **^4.4.9** (Vite 4.x).
- **Plan:** Upgrade to **Vite v7** when feasible.

Newer Vite versions include fixes and hardening for dev-server behaviour (including CVE-2025-30208 in affected versions). The upgrade will:

1. Remove reliance on the pattern block for this specific vulnerability once we are on a fixed Vite version.
2. Keep the `'/@fs/'` entry in `SUSPICIOUS_PATTERNS` as defence-in-depth unless we explicitly decide to drop it after verifying Vite v7 behaviour.

Until the upgrade is complete, the middleware-based block remains the primary mitigation for CVE-2025-30208 in this project.

---

## 5. Recommendations

1. **Secrets:** Rotate any credentials or API keys that could have been present in the process environment of the affected dev/preview process (especially given `/proc/self/environ` was exposed).
2. **Logging:** Retain and periodically review access logs for `/@fs/` and other suspicious patterns.
3. **Upgrade:** Proceed with the Vite v4 → v7 upgrade and re-test dev/build/preview; keep this report updated with the version and date of upgrade.

---

*End of report.*
